---
title: GPIO初始化函数笔记
---

1. 大致逻辑
   1. 提取相关位，判断是输入or输出
      1. if 是输出：配置速率
   2. 检查相关PIN选择位，配置CRL、CRH
      1. 通过循环找出待配Pin具体的所在位置
      2. 提取具体模式的参数并配置
         - 如果是输入模式，考虑上下拉模式问题
      3. CRL、CRH各做一次（操作基本一模一样）

2. 临时变量
   - tmpreg：临时（输入or输出、上拉or下拉）映射变量
   - currentpin：提取引脚
   - currentmode：配置输出速度
   - pos：确定currentmode在CRL、CRH中的配置位置



小结：

​	理解了实现逻辑后，实现的速度瓶颈在于对位运算操作的熟练度和相关位在寄存器的对应位置的熟悉度上。